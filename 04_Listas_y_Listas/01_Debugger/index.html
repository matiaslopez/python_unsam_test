<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://matiaslopez.github.io/python_unsam_test/04_Listas_y_Listas/01_Debugger/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>01 Debugger - Programación en Python</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-ABC123"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-ABC123');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-light bg-light">
            <div class="container">
                <a class="navbar-brand" href="../..">Programación en Python</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Inicio</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Unidades <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../01_Introduccion/00_Resumen/" class="dropdown-item">01 - Introducción</a>
</li>
                                    
<li>
    <a href="../../02_Estructuras_y_Funciones/00_Resumen/" class="dropdown-item">02 - Estructuras y funciones</a>
</li>
                                    
<li>
    <a href="../../03_Datos/00_Resumen/" class="dropdown-item">03 - Trabajando con datos</a>
</li>
                                    
<li>
    <a href="../00_Resumen/" class="dropdown-item">04 - Algoritmos sobre listas y comprensión de listas</a>
</li>
                                    
<li>
    <a href="../../05_Random_Plt_Dbg/00_Resumen/" class="dropdown-item">05 - Aleatoridad</a>
</li>
                                    
<li>
    <a href="../../06_Organizacion_y_Complejidad/00_Resumen/" class="dropdown-item">06 - Complejidad y Organización de programas</a>
</li>
                                    
<li>
    <a href="../../07_Plt_Especificacion_y_Documentacion/00_Resumen/" class="dropdown-item">07 - Diseño, especificación, documentación y estilo</a>
</li>
                                    
<li>
    <a href="../../08_Fechas_Carpetas_y_Pandas/00_Resumen/" class="dropdown-item">08 - Fechas, Carpetas y Pandas</a>
</li>
                                    
<li>
    <a href="../../09_Clases_y_Objetos/00_Resumen/" class="dropdown-item">09 - Clases y objetos</a>
</li>
                                    
<li>
    <a href="../../10_Generadores_e_Iteradores/00_Resumen/" class="dropdown-item">10 - Generadores e iteradores</a>
</li>
                                    
<li>
    <a href="../../11_Recursion/00_Resumen/" class="dropdown-item">11 - Recursión y regresión</a>
</li>
                                    
<li>
    <a href="../../12_Ordenamiento/00_Resumen/" class="dropdown-item">12 - Ordenamiento</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Buscar
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Tabla de contenidos">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#41-debuggear-programas" class="nav-link">4.1 Debuggear programas</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#testear-es-genial-debuggear-es-horrible" class="nav-link">Testear es genial, debuggear es horrible.</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#el-debugger-de-python-pdb" class="nav-link">El debugger de Python (pdb)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#ejercicios" class="nav-link">Ejercicios</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="../Contenidos.md">Contenidos</a> | <a href="../02_IteradoresLista/">Próximo (2 Listas y búsqueda lineal)</a></p>
<h1 id="41-debuggear-programas">4.1 Debuggear programas</h1>
<p>Python tiene un debugger poderoso que te permite probar porciones de código. Esto es sencillo y está integrado en IDEs como Spyder. </p>
<p>Vimos en la  <a href="../../03_Datos/01_Bugs/#tres-tipos-de-errores">Sección 3.1</a> diferentes ejemplos de problemas que pueden aparecer y tuviste que arremangarte e ingeniártelas para resolverlos a mano. En esta sección vamos a introducir la herramientas <em>pdb</em> (Python debugger) que ofrece el lenguaje para resolver este tipo de problemas.</p>
<h2 id="testear-es-genial-debuggear-es-horrible">Testear es genial, debuggear es horrible.</h2>
<p>Se dice que hay un <em>bug</em> (un error) cuando un programa no se comporta como el programador espera o hace algo inesperado. Es muy frecuente que los programas tengan bugs. Después de escribir un fragmento de código por primera vez, es conveniente correrlo algunas veces usando tests que permitan poner en evidencia esos bugs.</p>
<p>Diseñar un conjunto de <em>tests</em> adecuado no es una tarea sencilla y es frecuente que queden casos especiales que causen errores inesperados.</p>
<p>Python es un lenguaje interpretado, con tipos de datos dinámicos (una misma variable puede cambiar de tipo, de <code>int</code> a <code>float</code>, por ejemplo). No tiene un compilador que te alerte sobre inconsistencias de tipos antes de ejecutar el programa. Es bueno usar <em>buenas prácticas</em> que minimicen estos potenciales errores pero igual es posible que algunos errores se filtren.</p>
<p>Testear consiste en ejecutar un programa o porción de código en condiciones controladas, con entradas conocidas y salidas predichas de forma de poder verificar si lo que da el algoritmos es lo que esperabas.</p>
<p>La ejecución de un algoritmo puede pensarse como un árbol (el árbol de ejecución del algoritmo, cada condición booleana da lugar a una ramificación del árbol). Según la entrada que le des, el programa se va a ejecutar siguiendo una rama u otra. Lo ideal es testear todas las ramas posibles de ejecución y que los casos de prueba (<em>test cases</em>) incluyan todos los casos <em>especiales</em> (casos como listas vacías, índices apuntando al primer o al último elemento, claves ausentes, etc.) comprobando en cada caso que el programa se comporte según lo esperado.  </p>
<p><img alt="Partes del Spyder, un IDE para Python que facilita el debugging" src="../spyder-partes.png" /></p>
<p>Los entornos de desarrollo integrado (como el Spyder) dan la posiblidad de combinar el uso de un intérprete de Python con un editor de código y suelen integrar también el uso del debugger. Aún con herramientas como el Spyder, hacer debugging es lento y tedioso. Antes de entrar en los detalles de cómo hacerlo, comentaremos algunos métodos que tratan de reducir su necesidad. Profundizaremos sobre estos métodos más adelante.  </p>
<h3 id="aseveraciones-assert">Aseveraciones (assert)</h3>
<p>El comando <code>assert</code> se usa para un control interno del programa. Si la expresión que queremos verificar es <code>False</code>, se levanta una excepción de tipo <code>AssertionError</code>. La sintaxis de <code>assert</code> es la siguiente.</p>
<pre><code class="language-python">assert &lt;expresion&gt; [, 'Mensaje']
</code></pre>
<p>Por ejemplo</p>
<pre><code class="language-python">assert isinstance(10, int), 'Necesito un entero (int)'
</code></pre>
<p>La idea <em>no es</em> usarlo para comprobar la validez de lo ingresado por el usuario. El propósito de usar <code>assert</code> es verificar que ciertas condiciones se cumplan. En general se lo usa mientras el programa está en desarrollo, y luego se los quita o desactiva cuando el programa funciona.  </p>
<h3 id="programacion-por-contratos">Programación por contratos</h3>
<p>Se llama <code>programación por contratos</code> a una forma de programar en la que le programadore  define, para cada parte del programa, el tipo y formato de datos con que llamarla y el tipo de datos que devolverá. </p>
<p>Para asegurarse que los tipos de datos sean los esperados, el uso irrestricto de verificaciones puede ayudar en el diseño de software, y detecta tempranamente un error en los datos pasados a una función evitando que se propague.</p>
<p>Por ejemplo: podrías poner verificaciones para cada parámetro de una función.</p>
<pre><code class="language-python">def add(x, y):
    assert isinstance(x, int), 'Necesito un entero (int)'
    assert isinstance(y, int), 'Necesito un entero (int)'
    return x + y
</code></pre>
<p>De este modo, una funcion puede verificar que todos sus argumentos sean válidos.</p>
<pre><code class="language-python">&gt;&gt;&gt; add(2, 3)
5
&gt;&gt;&gt; add('2', '3')
Traceback (most recent call last):
...
AssertionError: Necesito un entero (int)
&gt;&gt;&gt;
</code></pre>
<h2 id="el-debugger-de-python-pdb">El debugger de Python (pdb)</h2>
<p>Es posible usar el debugger de Python directamente en el intérprete (sin interfaz gráfica) para seguir el funcionamiento de un programa. No vamos a entrar en esos detalles acá. Solo mencionamos que la función <code>breakpoint ()</code> inicia el debugger:</p>
<pre><code class="language-python">def mi_funcion():
    ...
    breakpoint()      # Iniciar el debugger (Python 3.7+)
    ...
</code></pre>
<p>Podés encontrar instrucciones detalladas <a href="https://docs.python.org/3/library/pdb.html">acá</a> sobre como usarlo. </p>
<p>Nos resulta más cómodo usar un IDE como Spyder para hacer debugging y ése es el método que describiremos aquí. Este es el menú desplegable del debugger:</p>
<p><img alt="Menu Debug, en Spyder" src="../debug_menu.png" /></p>
<p>Fijate los nombres de cada ícono: </p>
<table>
<thead>
<tr>
<th>Nombre</th>
<th>Acción</th>
</tr>
</thead>
<tbody>
<tr>
<td>Debug</td>
<td>inicia el modo debug</td>
</tr>
<tr>
<td>Step</td>
<td>da un paso en el programa</td>
</tr>
<tr>
<td>Step Into</td>
<td>entra en la función referida</td>
</tr>
<tr>
<td>Step Return</td>
<td>ejecuta hasta salir de la función</td>
</tr>
<tr>
<td>Continue</td>
<td>retoma la ejecución normal</td>
</tr>
<tr>
<td>Stop</td>
<td>detiene el programa</td>
</tr>
</tbody>
</table>
<p>Vamos a volver a analizar el siguiente código, similar al del <a href="../../03_Datos/01_Bugs/#ejercicio-31-semántica">Ejercicio 3.1</a> para que veas la utilidad del debugger:</p>
<pre><code class="language-python">def tiene_a(expresion):
    n = len(expresion)
    i = 0
    while i&lt;n:
        if expresion[i] == 'a':
            return True
        else:
            return False
        i += 1

rta = tiene_a ('palabra')
print(rta)
</code></pre>
<p>Una vez que tengas el código copiado en el Spyder, vamos a ejecutarlo en <em>modo debug</em>:</p>
<p>Primero entramos al <em>modo debug</em> (Ctrl+F5): El programa queda pausado antes de comenzar. Notá los cambios en la ventana interactiva.</p>
<p><img alt="Menu Debug, en Spyder" src="../debug2.jpg" /></p>
<p>Si damos un paso en el programa: ¿qué va a ocurrir? Debemos tratar de responder esta pregunta antes de avanzar cada paso. <em>Es nuestra predicción, contrastada con lo que realmente sucede, lo que delata el error</em>.</p>
<p>Queremos ver la evolución de las variables en la solapa <em>Variable Explorer</em> (solapa del centro en el panel superior de la derecha). El programa está en ejecución pero pausado. Sabemos que estamos en <em>modo debug</em> por el prompt <code>ipdb&gt;</code> abajo.</p>
<p>Damos algunos pasos (con <code>Step</code>, Ctrl + F10) hasta llegar a la llamada a la función <code>tiene_a()</code> que queremos analizar. </p>
<p><img alt="Menu Debug, en Spyder" src="../debug3.jpg" /></p>
<p>Fijate que el debugger pasó por la línea de definición de la función (y ahora sabe dónde ir a buscarla) pero nunca entró al cuerpo de la función aún. Eso va a ocurrir recién al llamarla.</p>
<p>A esta altura, no queremos simplemente dar un paso (eso ejecutaría la función entera, de una) sino entrar en los detalles de esta función. Para eso usamos <code>Step Into</code> (Ctrl + F11) de forma de entrar en la ejecución de la función <code>tiene_a()</code>. Una vez dentro, seguimos dando pasos (con <code>Step</code>, Ctrl + F10), siempre pensando qué esperamos que haga la función y observando la evolución de las variables en el explorador de variables. Sigamos así hasta llegar al condicional <code>if</code>. Vemos en el <em>Variable Explorer</em> que todas las variables internas de la función están definidas y con sus valores asignados.</p>
<p><img alt="Menu Debug, en Spyder" src="../debug4.jpg" /></p>
<p>Como <code>i = 0</code> sabemos que es la primera iteración. Corroboramos que <code>n=7</code> (“palabra” tiene 7 letras). En este punto se evalúa <code>if palabra[i] == 'a':</code>, y saltaremos a alguna de las dos ramas de ejecución según la evaluación resulte <code>True</code> o <code>False</code>.</p>
<p>La expresión resulta <code>False</code> ya que la primera letra de 'palabra' es la 'p' y no una 'a'. Pero entonces la siguiente instrucción será <code>return False</code> con lo que saldremos de la función habiendo sólo evaluado la primera letra de la palabra pasada como parámetro. ¿Esto es lo que queríamos?</p>
<p><img alt="Menu Debug, en Spyder" src="../debug5.jpg" /></p>
<p>Acabamos de volver de la función. Las variables internas a la función ya no están visibles (salimos de su alcance o <em>scope</em>). El programa sigue en ejecución, en <em>modo debug</em>.</p>
<p>Si seguimos dando pasos con <code>Step</code> (Ctrl + F10) vamos a pasar por el <code>print()</code> y terminar la ejecución del programa, saliendo del <em>modo debug</em>.</p>
<p>Si, en cambio, al llegar a la línea del <code>print()</code> en lugar de <code>Step</code> (Ctrl + F10) avanzáramos con un <code>Step Into</code> (Ctrl + F11), entraríamos en los detalles de la definición de esta función y la cosa se pondría un toque técnica. Cuando esto ocurre es útil usar el <code>Step Return</code> (Ctrl + Shift + F11) para salir de tanto nivel de detalle.</p>
<p>En todo caso, lo que observamos en esta ejecución de <code>tiene_a()</code> es que salimos de la función después de haber analizado sólo la primera letra de la palabra. ¿Es correcto esto? ¿Donde está el error? ¿Cómo lo podemos resolver?</p>
<p><strong>Comentario.</strong> Recorrer la ejecución de un programa como un simple espectador no nos muestra claramente un error en el código. Es la incongruencia entre lo esperado y lo que realmente sucede lo que lo marca. Esto exige mucha atención para, antes de ejecutar cada paso, preguntarse: ¿qué espero que ocurra? Luego, al avanzar un paso en la ejecución, puede ocurrir que lo que esperamos que pase no sea lo que realmente pasa. Entonces estamos en un <strong>paso clave</strong> de la  ejecución, que nos marca que estamos frente a una de dos: ó frente a un error en el código ó frente a la oportunidad de mejorar nuestra comprensión del mismo.</p>
<h2 id="ejercicios">Ejercicios</h2>
<h3 id="ejercicio-41-debugger">Ejercicio 4.1: Debugger</h3>
<p>Ingresá y corré el siguiente código en tu IDE:</p>
<pre><code class="language-python">def invertir_lista(lista):
    '''Recibe una lista L y la develve invertida.'''
    invertida = []
    i = len(lista)
    while i &gt; 0:    # tomo el último elemento 
        i = i-1
        invertida.append (lista.pop(i))  #
    return invertida

l = [1, 2, 3, 4, 5]    
m = invertir_lista(l)
print(f'Entrada {l}, Salida: {m}')
</code></pre>
<p>Deberías observar que la función modifica el valor de la lista de entrada. Eso no debería ocurrir: una función nunca debería modificar los parámetros salvo que sea lo esperado.  Usá el debugger y el explorador de variables para determinar cuál es el primer <strong>paso clave</strong> en el que se modifica el valor de esta variable.</p>
<h3 id="ejercicio-42-mas-debugger">Ejercicio 4.2: Más debugger</h3>
<p>Siguiendo con los ejemplos del <a href="../../03_Datos/01_Bugs/#ejercicio-31-semántica">Ejercicio 3.1</a>, usá el debugger para analizar el siguiente código:</p>
<pre><code class="language-python">import csv
from pprint import pprint

def leer_camion(nombre_archivo):
    camion = []
    registro = {}
    with open(nombre_archivo,&quot;rt&quot;) as f:
        filas = csv.reader(f)
        encabezado = next(filas)
        for fila in filas:
            registro[encabezado[0]] = fila[0]
            registro[encabezado[1]] = int(fila[1])
            registro[encabezado[2]] = float(fila[2])
            camion.append(registro)
    return camion

camion = leer_camion('../Data/camion.csv')
pprint(camion)
</code></pre>
<p>Observá en particular lo que ocurre al leer la segunda fila de datos del archivo y guardarlos en la variable <code>registro</code> con los datos ya guardados en la lista <code>camion</code>.</p>
<h3 id="mas-ejercitacion-con-el-debugger">Más ejercitacion con el debugger?</h3>
<p><a href="../Contenidos.md">Contenidos</a> | <a href="../02_IteradoresLista/">Próximo (2 Listas y búsqueda lineal)</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentación construida con <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Buscar</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Cerrar</span></button>
            </div>
            <div class="modal-body">
                <p>Desde aquí puede buscar estos documentos. Ingrese sus términos de búsqueda a continuación.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Buscando..." id="mkdocs-search-query" title="Escriba el término de búsqueda aquí">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No se encontraron resultados"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Atajos de teclado</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Cerrar</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Teclas</th>
                    <th>Acción</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Abrir esta ayuda</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Página siguiente</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Página anterior</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Buscar</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
