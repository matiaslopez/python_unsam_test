<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://matiaslopez.github.io/python_unsam_test/08_Fechas_Carpetas_y_Pandas/05_Pandas/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>05 Pandas - Programación en Python</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-ABC123"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-ABC123');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-light bg-light">
            <div class="container">
                <a class="navbar-brand" href="../..">Programación en Python</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Inicio</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Unidades <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../01_Introduccion/00_Resumen/" class="dropdown-item">01 - Introducción</a>
</li>
                                    
<li>
    <a href="../../02_Estructuras_y_Funciones/00_Resumen/" class="dropdown-item">02 - Estructuras y funciones</a>
</li>
                                    
<li>
    <a href="../../03_Datos/00_Resumen/" class="dropdown-item">03 - Trabajando con datos</a>
</li>
                                    
<li>
    <a href="../../04_Listas_y_Listas/00_Resumen/" class="dropdown-item">04 - Algoritmos sobre listas y comprensión de listas</a>
</li>
                                    
<li>
    <a href="../../05_Random_Plt_Dbg/00_Resumen/" class="dropdown-item">05 - Aleatoridad</a>
</li>
                                    
<li>
    <a href="../../06_Organizacion_y_Complejidad/00_Resumen/" class="dropdown-item">06 - Complejidad y Organización de programas</a>
</li>
                                    
<li>
    <a href="../../07_Plt_Especificacion_y_Documentacion/00_Resumen/" class="dropdown-item">07 - Diseño, especificación, documentación y estilo</a>
</li>
                                    
<li>
    <a href="../00_Resumen/" class="dropdown-item">08 - Fechas, Carpetas y Pandas</a>
</li>
                                    
<li>
    <a href="../../09_Clases_y_Objetos/00_Resumen/" class="dropdown-item">09 - Clases y objetos</a>
</li>
                                    
<li>
    <a href="../../10_Generadores_e_Iteradores/00_Resumen/" class="dropdown-item">10 - Generadores e iteradores</a>
</li>
                                    
<li>
    <a href="../../11_Recursion/00_Resumen/" class="dropdown-item">11 - Recursión y regresión</a>
</li>
                                    
<li>
    <a href="../../12_Ordenamiento/00_Resumen/" class="dropdown-item">12 - Ordenamiento</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Buscar
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Tabla de contenidos">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#85-introduccion-a-pandas" class="nav-link">8.5 Introducción a Pandas</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#lectura-de-datos" class="nav-link">Lectura de datos</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#seleccion" class="nav-link">Selección</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#series-temporales-en-pandas" class="nav-link">Series temporales en Pandas</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#incorporando-el-arbolado-lineal" class="nav-link">Incorporando el Arbolado lineal</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="../Contenidos.md">Contenidos</a> | <a href="../04_Ordenando_archivos/">Anterior (4 Ordenar archivos en Python)</a> | <a href="../06_Series_Temporales/">Próximo (6 Series temporales)</a></p>
<h1 id="85-introduccion-a-pandas">8.5 Introducción a Pandas</h1>
<p>La  biblioteca Pandas es una extensión de NumPy para manipulación y análisis de datos. En particular, ofrece estructuras de datos y operaciones para manipular tablas de datos (numéricos y de otros tipos) y series temporales. Se distribuye como software libre.</p>
<p>Ésta es una breve introducción a <a href="https://pandas.pydata.org/docs/getting_started/index.html">Pandas</a>. Para información más completa, te recomendamos consultar <a href="https://pandas.pydata.org/docs/user_guide/10min.html">la documentación oficial</a>.</p>
<p>Esta biblioteca tiene dos tipos de datos fundamentales: los <code>DataFrames</code> que almacenan tablas de datos y las <code>series</code> que contienen secuencias de datos.</p>
<p>Esta sección tiene un breve <a href="https://youtu.be/aQhssTeFnYY">video introductorio</a> sobre las posibilidades que ofrece la biblioteca Pandas.</p>
<h2 id="lectura-de-datos">Lectura de datos</h2>
<p>Pandas permite leer diversos formatos de tablas de datos directamente. Probá el siguiente código, para leer un archivo CSV:</p>
<pre><code class="language-python">import pandas as pd
import os

directorio = '../Data'
archivo = 'arbolado-en-espacios-verdes.csv'
fname = os.path.join(directorio,archivo)
df = pd.read_csv(fname)
</code></pre>
<p>La variable <code>df</code> es de tipo <code>DataFrame</code> y contiene todos los datos del archivo csv estructurados adecuadamente.</p>
<p>Con <code>df.head()</code> podés ver las primeras líneas de datos. Si a <code>head</code> le pasás un número como parámetro podés seleccionar cuántas líneas querés ver. Análogamente con <code>df.tail(n)</code> verás las últimas <code>n</code> líneas de datos.</p>
<pre><code class="language-python">&gt;&gt;&gt; df.head()

   long       lat      id_arbol ...          origen       coord_x       coord_y
0 -58.477564 -34.645015    1  ...           Exótico  98692.305719  98253.300738
1 -58.477559 -34.645047    2  ...           Exótico  98692.751564  98249.733979
2 -58.477551 -34.645091    3  ...           Exótico  98693.494639  98244.829684
3 -58.478129 -34.644567    4  ...  Nativo/Autóctono  98640.439091  98302.938142
4 -58.478121 -34.644598    5  ...  Nativo/Autóctono  98641.182166  98299.519997
</code></pre>
<p>Usando <code>df.columns</code> pandas te va a devolver un índice con los nombres de las columnas del DataFrame. Recordá que en la <a href="../../03_Datos/06_Arboles1/#descripción-de-la-base">Sección 3.6</a> describimos la base de datos. A su vez, <code>df.index</code> te mostrará el índice. En este caso el índice es numérico y se corresponde con el número de la línea leida del archivo. En principio no es muy interesante para analizar cuestiones de árboles, simplemente tenemos las filas numeradas. Veremos otros ejemplos donde el índice puede contener información vital (una categoría, un timestamp, etc).</p>
<pre><code class="language-python">&gt;&gt;&gt; df.columns
Index(['long', 'lat', 'id_arbol', 'altura_tot', 'diametro', 'inclinacio',
       'id_especie', 'nombre_com', 'nombre_cie', 'tipo_folla', 'espacio_ve',
       'ubicacion', 'nombre_fam', 'nombre_gen', 'origen', 'coord_x',
       'coord_y'],
      dtype='object')
&gt;&gt;&gt; df.index
RangeIndex(start=0, stop=51502, step=1)
</code></pre>
<p>Otra herramienta útil para inspeccionar los datos recién levantados es <code>describe()</code>. Para ver mejor una parte, podemos seleccionar algunas columnas de interés antes de pedirle la descripción.</p>
<pre><code class="language-python">&gt;&gt;&gt; df[['altura_tot', 'diametro', 'inclinacio']].describe()
         altura_tot      diametro    inclinacio
count  51502.000000  51502.000000  51502.000000
mean      12.167100     39.395616      3.472215
std        7.640309     31.171205      7.039495
min        0.000000      1.000000      0.000000
25%        6.000000     18.000000      0.000000
50%       11.000000     32.000000      0.000000
75%       18.000000     54.000000      5.000000
max       54.000000    500.000000     90.000000
</code></pre>
<h2 id="seleccion">Selección</h2>
<p>Una de las operaciones primitivas más importantes es la selección de fragmentos de las tablas de datos, ya sean filas, columnas o rangos de filas y columnas.</p>
<p>Por ejemplo con <code>df['nombre_com']</code> veremos la columna (que es una serie) de nombres comunes de los árboles en la base. Podemos usar <code>unique</code> para ver una vez cada nombre:</p>
<pre><code class="language-python">&gt;&gt;&gt; df['nombre_com'].unique()
array(['Washingtonia (Palmera washingtonia)', 'Ombú', 'Catalpa', 'Ceibo',
       'Brachichiton (Árbol botella, Brachichito)', 'Álamo plateado',
       'Acacia de constantinopla', 'Acacia', 'Roble sedoso (Grevillea)',
        ...
       'Jazmín del Paraguay', 'Plumerillo rojo', 'Árbol fuccia',
       'Canela de venado', 'Boj cepillo', 'Caranday'], dtype=object)
</code></pre>
<p>Podemos preguntar cuáles se llaman de cierta manera ('Ombú' en este caso), como hacíamos con los ndarrays en numpy:</p>
<pre><code class="language-python">&gt;&gt;&gt; df['nombre_com'] == 'Ombú'
0        False
1        False
2        False
3         True
...
</code></pre>
<p>Observá que esto generó una serie. Podemos sumar los <code>True</code> de esta serie para contar la cantidad de Ombús:</p>
<pre><code class="language-python">&gt;&gt;&gt; (df['nombre_com'] == 'Ombú').sum()
590
</code></pre>
<p>Si queremos hacer lo mismo para otras especies podemos usar <code>value_counts()</code></p>
<pre><code class="language-python">&gt;&gt;&gt; cant_ejemplares = df['nombre_com'].value_counts()
&gt;&gt;&gt; cant_ejemplares.head(10)
Eucalipto               4112
Tipa blanca             4031
Jacarandá               3255
Palo borracho rosado    3150
Casuarina               2719
Fresno americano        2166
Plátano                 1556
Ciprés                  1467
Ceibo                   1149
Pindó                   1068
Name: nombre_com, dtype: int64
</code></pre>
<p>De esta forma obtenemos, en orden decreciente, los nombres comunes y las cantidades de las especies más frecuentes en la base de datos.</p>
<h3 id="filtros-booleanos">Filtros booleanos</h3>
<p>La serie booleana que obtuvimos con <code>df['nombre_com'] == 'Ombú'</code> puede usarse para seleccionar esas filas del DataFrame. Probemos con Jacarandá:</p>
<pre><code class="language-python">&gt;&gt;&gt; df_jacarandas = df[df['nombre_com'] == 'Jacarandá']
</code></pre>
<p>Análogamente, podemos seleccionar algunas columnas de interés y generar vistas (ojo, en estos casos no estamos copiando la información):</p>
<pre><code class="language-python">&gt;&gt;&gt; cols = ['altura_tot', 'diametro', 'inclinacio']
&gt;&gt;&gt; df_jacarandas = df_jacarandas[cols]
&gt;&gt;&gt; df_jacarandas.tail()
       altura_tot  diametro  inclinacio
51104           7        97           4
51172           8        28           8
51180           2        30           0
51207           3        10           0
51375          17        40          20

&gt;&gt;&gt; df_jacarandas.describe()
        altura_tot     diametro   inclinacio
count  3255.000000  3255.000000  3255.000000
mean     10.369585    28.804301     6.549923
std       5.905744    19.166388     8.459921
min       1.000000     1.000000     0.000000
25%       6.000000    14.000000     0.000000
50%      10.000000    25.000000     4.000000
75%      15.000000    41.000000    10.000000
max      49.000000   159.000000    70.000000
</code></pre>
<p>Observá que cuando le pedimos los últimos datos de <code>df_jacarandas</code> nos mostró los últimos 5 jacarandás de la base de datos, respetando los números de índice de la tabla original (..., 51207, 51375).</p>
<p>Si vas a querer modificar <code>df_jacarandas</code> es conveniente crear una copia de los datos de <code>df</code> en lugar de simplemente una vista. Esto se puede hacer con el método <code>copy()</code> como en el siguiente ejemplo.</p>
<pre><code class="language-python">&gt;&gt;&gt; df_jacarandas = df[df['nombre_com'] == 'Jacarandá'][cols].copy()
</code></pre>
<h3 id="scatterplots">Scatterplots</h3>
<p>Pandas también permite <a href="https://pandas.pydata.org/docs/user_guide/visualization.html">hacer gráficos bonitos</a>. Es realmente sencillo:</p>
<pre><code class="language-python">df_jacarandas.plot.scatter(x = 'diametro', y = 'altura_tot')
</code></pre>
<p>Hay otro módulo para hacer gráficos que interactúa muy bien con pandas y se llama <a href="https://seaborn.pydata.org/">Seaborn</a>. Está basado en matplotlib, y ofrece una interfaz de alto nivel para realizar gráficos estadísticos atractivos e informativos. En criollo: "usar pandas para manejar los datos y seaborn para visualizarlos, es la posta".</p>
<p>Fijate que seaborn entiende los DataFrames y las columnas y su sintaxis es muy similar a la de pandas:</p>
<pre><code class="language-python">import seaborn as sns

sns.scatterplot(data = df_jacarandas, x = 'diametro', y = 'altura_tot')
</code></pre>
<h3 id="filtros-por-indice-y-por-posicion">Filtros por índice y por posición</h3>
<p>Como ya mencionamos, el índice de <code>df</code> no tiene una semántica interesante. Veamos, en cambio, que la serie que generamos con <code>cant_ejemplares = df['nombre_com'].value_counts()</code> sí lo tiene:</p>
<pre><code class="language-python">&gt;&gt;&gt; cant_ejemplares.index
Index(['Eucalipto', 'Tipa blanca', 'Jacarandá', 'Palo borracho rosado',
       'Casuarina', 'Fresno americano', 'Plátano', 'Ciprés', 'Ceibo', 'Pindó',
       ...
       'Naranjo dulce', 'Peltophorum', 'Ligustrina de California',
       'Afrocarpus', 'Caranday', 'Esterculea', 'Boj cepillo', 'Sesbania',
       'Ligustrum', 'Árbol del humo'],
      dtype='object', length=337)
</code></pre>
<p><code>cant_ejemplares</code> es una serie (es como un DataFrame de una sola columna). Tiene los nombres de las especies como índice y sus respectivas cantidades como dato asociado.</p>
<p>Podemos acceder a una fila de un DataFarme o una Serie tanto a través de su posición como a través de su índice. Para acceder con el índice usá <code>loc[]</code> como en los siguientes ejemplos:</p>
<pre><code class="language-python">&gt;&gt;&gt; df.loc[165]
long                                                   -58.4684
lat                                                    -34.6648
id_arbol                                                    166
altura_tot                                                    5
diametro                                                     10
inclinacio                                                    0
id_especie                                                   11
nombre_com                                            Jacarandá
nombre_cie                                Jacarandá mimosifolia
tipo_folla                        Árbol Latifoliado Caducifolio
espacio_ve                                        INDOAMERICANO
ubicacion     LACARRA, Av. - ESCALADA, Av. - CASTAÑARES, Av....
nombre_fam                                         Bignoniáceas
nombre_gen                                            Jacarandá
origen                                         Nativo/Autóctono
coord_x                                                 99534.3
coord_y                                                 96061.8
Name: 165, dtype: object

&gt;&gt;&gt; cant_ejemplares.loc['Eucalipto']
4112
</code></pre>
<p>Para acceder por número de posición usá <code>iloc</code>, como se muestra a continuación.</p>
<pre><code class="language-python">&gt;&gt;&gt; df_jacarandas.iloc[0]
altura_tot     5
diametro      10
inclinacio     0
Name: 165, dtype: int64
</code></pre>
<p>Observá que esto nos devuelve los datos de la primera fila de <code>df_jacarandas</code> que corresponde al índice 165 (lo dice en la última línea). También podemos acceder a rebanadas (slices) usando <code>iloc</code>:</p>
<pre><code class="language-python">&gt;&gt;&gt; cant_ejemplares.iloc[0:3]
Eucalipto      4112
Tipa blanca    4031
Jacarandá      3255
Name: nombre_com, dtype: int64
</code></pre>
<p>Por otra parte, podemos seleccionar tanto filas como columnas, si separamos con comas las respectivas selecciones:</p>
<pre><code class="language-python">&gt;&gt;&gt; df_jacarandas.iloc[-5:,2]
51104     4
51172     8
51180     0
51207     0
51375    20
Name: inclinacio, dtype: int64
</code></pre>
<p>Esto nos devuelve los datos correspondientes a las últimas 5 filas y a la tercera columna ('inclinacio'). Fijate que siempre vienen acompañados del índice.</p>
<h3 id="seleccion-de-una-columna">Selección de una columna</h3>
<p>Si queremos seleccionar una sola columna podemos especificarla por medio de su nombre. Recordemos que al tomar una sola columna obtenemos una serie en lugar de un DataFrame:</p>
<pre><code class="language-python">&gt;&gt;&gt; df_jacarandas_diam = df_jacarandas['diametro']
&gt;&gt;&gt; type(df_jacarandas)
pandas.core.frame.DataFrame
&gt;&gt;&gt; type(df_jacarandas_diam)
pandas.core.series.Series
</code></pre>
<h2 id="series-temporales-en-pandas">Series temporales en Pandas</h2>
<p>Pandas tiene un gran potencial para el manejo de series temporales. Es muy sencillo crear índices con fechas y frecuencias seleccionadas.</p>
<pre><code class="language-python">&gt;&gt;&gt; pd.date_range('20200923', periods = 7)
DatetimeIndex(['2020-09-23', '2020-09-24', '2020-09-25', '2020-09-26',
               '2020-09-27', '2020-09-28', '2020-09-29'],
              dtype='datetime64[ns]', freq='D')

&gt;&gt;&gt; pd.date_range('20200923 14:00', periods = 7)
DatetimeIndex(['2020-09-23 14:00:00', '2020-09-24 14:00:00',
               '2020-09-25 14:00:00', '2020-09-26 14:00:00',
               '2020-09-27 14:00:00', '2020-09-28 14:00:00',
               '2020-09-29 14:00:00'],
              dtype='datetime64[ns]', freq='D')

&gt;&gt;&gt; pd.date_range('20200923 14:00', periods = 6, freq = 'H')
DatetimeIndex(['2020-09-23 14:00:00', '2020-09-23 15:00:00',
               '2020-09-23 16:00:00', '2020-09-23 17:00:00',
               '2020-09-23 18:00:00', '2020-09-23 19:00:00'],
              dtype='datetime64[ns]', freq='H')

</code></pre>
<p>Luego, podés usar esos índices junto con datos para armar series temporales o DataFrames:</p>
<pre><code class="language-python">&gt;&gt;&gt; pd.Series([1, 2, 3, 4, 5, 6], index = pd.date_range('20200923 14:00', periods = 6, freq = 'H'))
2020-09-23 14:00:00    1
2020-09-23 15:00:00    2
2020-09-23 16:00:00    3
2020-09-23 17:00:00    4
2020-09-23 18:00:00    5
2020-09-23 19:00:00    6
Freq: H, dtype: int64
</code></pre>
<h3 id="caminatas-al-azar">Caminatas al azar</h3>
<p>Volviendo al tema de las caminatas al azar, podemos hacer una caminata de dos horas dando un paso por minuto a partir del comienzo de esta clase con el siguiente comando:</p>
<pre><code class="language-python">import numpy as np

idx = pd.date_range('20200923 14:00', periods = 120, freq = 'min')
s1 = pd.Series(np.random.randint(-1,2,120), index = idx)
s2 = s1.cumsum()
</code></pre>
<p>Observá que estamos usando random del módulo numpy, no de random. La función <code>np.random.randint(-1,2,120)</code> genera un array de longitud 120 con valores -1, 0, 1 (no incluye extremo derecho del rango de valores).</p>
<p>Podemos ver el gráfico sencillamente:</p>
<pre><code class="language-python">s2.plot()
</code></pre>
<p>O usar una <a href="https://es.wikipedia.org/wiki/Media_m%C3%B3vil">media móvil</a> (rolling mean) para suavizar los datos:</p>
<pre><code class="language-python">w = 5 # ancho en minutos de la ventana
s3 = s2.rolling(w).mean()
s3.plot()
</code></pre>
<p>Podés ver ambas curvas en un mismo gráfico para ver más claramente el efecto del suavizado:</p>
<pre><code class="language-python">df_series_23 = pd.DataFrame([s2, s3]).T  # armo un dataframe con ambas series
df_series_23.plot()
</code></pre>
<p>Fijate que los datos de la curva suavizada empiezan más tarde, porque al principio no hay datos sobre los cuales hacer promedio. El parámetro  <code>min_periods = 1</code> del método <code>rolling</code> te permite controlar esto. Probalo.</p>
<h3 id="ejemplo-12-personas-caminando-8-horas">Ejemplo: 12 personas caminando 8 horas</h3>
<p>En el siguiente ejemplo creamos un índice que contenga un elemento por minuto a partir del comienzo de la clase y durante 8 horas. Armamos también una lista de nombres.</p>
<pre><code class="language-python">horas = 8
idx = pd.date_range('20200923 14:00', periods = horas*60, freq = 'min')
nombres = ['Pedro', 'Santiago', 'Juan', 'Andrés','Bartolomé','Tiago','Isca','Tadeo','Mateo','Felipe','Simón','Tomás']
</code></pre>
<p>Luego usamos el módulo random de numpy para generar pasos para cada persona a cada minuto. Los acumulamos con <code>cumsum</code> y los acomodamos en un DataFrame, usando el índice generado antes y poniéndoles nombres adecuados a cada columna:</p>
<pre><code class="language-python">df_walks = pd.DataFrame(np.random.randint(-1,2,[horas*60,12]).cumsum(axis=0), index = idx, columns = nombres)
df_walks.plot()
</code></pre>
<p>Ahora suavizamos los datos, usando <code>min_periods</code> para no perder los datos de los extremos.</p>
<pre><code class="language-python">w = 45
df_walk_suav = df_walks.rolling(w, min_periods = 1).mean() # datos suavizados
nsuav = ['S_' + n for n in nombres]
df_walk_suav.columns = nsuav # cambio el nombre de las columnas
                             # para los datos suavizados
df_walk_suav.plot()
</code></pre>
<h3 id="guardando-datos">Guardando datos</h3>
<p>Guardar una serie o un DataFrame en el disco es algo realmente sencillo. Probá, por ejemplo, el efecto del comando <code>df_walk_suav.to_csv('caminata_apostolica.csv')</code>.</p>
<h2 id="incorporando-el-arbolado-lineal">Incorporando el Arbolado lineal</h2>
<h3 id="ejercicio-87-lectura-y-seleccion">Ejercicio 8.7: Lectura y selección</h3>
<p>Vamos a trabajar ahora con el archivo <a href="https://data.buenosaires.gob.ar/dataset/arbolado-publico-lineal">'arbolado-publico-lineal-2017-2018.csv'</a>. Descargalo y guardalo en tu directorio '../Data/'.</p>
<p>Levantalo y armá un DataFrame <code>df_lineal</code> que tenga solamente las siguiente columnas:</p>
<pre><code class="language-python">cols_sel = ['nombre_cientifico', 'ancho_acera', 'diametro_altura_pecho', 'altura_arbol']
</code></pre>
<p>Imprimí las diez especies más frecuentes con sus respectivas cantidades.</p>
<p>Trabajaremos con las siguientes especies seleccionadas:</p>
<pre><code class="language-python">especies_seleccionadas = ['Tilia x moltkei', 'Jacaranda mimosifolia', 'Tipuana tipu']
</code></pre>
<p>Una forma de seleccionarlas es la siguiente:</p>
<pre><code class="language-python">df_lineal_seleccion = df_lineal[df_lineal['nombre_cientifico'].isin(especies_seleccionadas)]
</code></pre>
<h3 id="ejercicio-88-boxplots">Ejercicio 8.8: Boxplots</h3>
<p>El siguiente comando realiza un <a href="https://es.wikipedia.org/wiki/Diagrama_de_caja">boxplot</a> de los diámetros de los árboles agrupados por especie.</p>
<pre><code class="language-python">df_lineal_seleccion.boxplot('diametro_altura_pecho', by = 'nombre_cientifico')
</code></pre>
<p>Realizá un gráfico similar pero de los altos en lugar de los diámetros de los árboles.</p>
<h3 id="ejemplo-de-pairplot">Ejemplo de pairplot</h3>
<p>Otro gráfico interesante que resume muy bien la información es el <em>pairplot</em> de seaborn que es una grilla cuadrada de subplots.</p>
<p>Probá el siguiente código:</p>
<pre><code class="language-python">sns.pairplot(data = df_lineal_seleccion[cols_sel], hue = 'nombre_cientifico')
</code></pre>
<p><img alt="Figura" src="../Figure200027.png" /></p>
<p>El gráfico va a tener una fila (y columna) por cada variable numérica en el DataFrame pasado como <code>data</code>. En la diagonal del gŕafico, va a haber kdeplots (kernel density estimation plots, una versión suavizada de los histogramas) y fuera de la diagonal scatterplots combinando todos los pares de variables (cada combinación aparece dos veces, una sobre y otra debajo de la diagonal).</p>
<p>El <code>hue</code> selecciona la variable categórica a usar para distinguir subgrupos y asociarles colores. En la diagonal de este ejemplo (y en los scatterplots también) se ve por ejemplo que las Tipas suelen ser más anchas y más altas que los Tilos y los Jacarandás.</p>
<p>Pregunta: ¿Por qué el ancho_acera no tiene lugar en el gráfico?</p>
<p><em>Te recomendamos pegarle una mirada a <a href="http://seaborn.pydata.org/introduction.html">esta página</a> donde vas a poder ver un poco más sobre el potencial de seaborn.</em></p>
<h3 id="ejercicio-89-comparando-especies-en-parques-y-en-veredas">Ejercicio 8.9: Comparando especies en parques y en veredas</h3>
<p>Al comienzo de la materia estuvimos trabajando con el dataset de árboles en parques. Ahora estuvimos analizando otro dataset: el de árboles en veredas.
Ahora queremos estudiar si hay diferencias entre los ejemplares de una misma especie según si crecen en un sitio o en otro. Queremos hacer un boxplot del diámetro a la altura del pecho para las Tipas (su nombre científico es <em>tipuana tipu</em>), que crecen en ambos tipos de ambiente. Para eso tendremos que juntar datos de dos bases de datos diferentes.</p>
<p>Nos vamos en meter en un lío. El GCBA usa en un dataset 'altura_tot', 'diametro' y 'nombre_cie' para las alturas, diámetros y nombres científicos de los ejemplares, y en el otro dataset usa 'altura_arbol', 'diametro_altura_pecho' y 'nombre_cientifico' para los mismos datos.</p>
<p>Es más, los nombres científicos varían de un dataset al otro. 'Tipuana Tipu' se transforma en 'Tipuana tipu' y 'Jacarandá mimosifolia' en 'Jacaranda mimosifolia'. Obviamente son cambios menores pero suficientes para desalentar al usuarie desprevenide.</p>
<p>En este ejercicio te proponemos los siguientes pasos para comparar los diámetros a la altura del pecho de las tipas en ambos tipos de entornos. Guardá este trabajo en un archivo <code>arbolado_parques_veredas.py</code>.</p>
<ol>
<li>Abrí ambos datasets a los que llamaremos df_parques y df_veredas.</li>
<li>Para cada dataset armate otro seleccionando solamente las filas correspondientes a las tipas (llamalos df_tipas_parques y df_tipas_veredas, respectivamente) y las columnas correspondientes al diametro a la altura del pecho y alturas. Hacelo como copias (usando <code>.copy()</code> como hicimos más arriba) para poder trabajar en estos nuevos dataframes sin modificar los dataframes grandes originales. Renombrá las columnas que muestran la altura y el diámetro a la altura del pecho para que se llamen igual en ambos dataframes, para ello explorá el comando <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rename.html"><code>rename</code></a>.</li>
<li>Agregale a cada dataframe (df_tipas_parques y df_tipas_veredas) una columna llamada 'ambiente' que en un caso valga siempre 'parque' y en el otro caso 'vereda'.</li>
<li>Juntá ambos datasets con el comando <code>df_tipas = pd.concat([df_tipas_veredas, df_tipas_parques])</code>. De esta forma tenemos en un mismo dataframe la información de las tipas distinguidas por ambiente.</li>
<li>Creá un boxplot para los diámetros a la altura del pecho de la tipas distinguiendo los ambientes (<code>boxplot('diametro_altura_pecho',by = 'ambiente')</code>).</li>
<li>Repetí para alturas.</li>
<li>¿Qué tendrías que cambiar para repetir el análisis para otras especies? ¿Convendría definir una función?</li>
</ol>
<p><a href="../Contenidos.md">Contenidos</a> | <a href="../04_Ordenando_archivos/">Anterior (4 Ordenar archivos en Python)</a> | <a href="../06_Series_Temporales/">Próximo (6 Series temporales)</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentación construida con <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Buscar</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Cerrar</span></button>
            </div>
            <div class="modal-body">
                <p>Desde aquí puede buscar estos documentos. Ingrese sus términos de búsqueda a continuación.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Buscando..." id="mkdocs-search-query" title="Escriba el término de búsqueda aquí">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No se encontraron resultados"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Atajos de teclado</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Cerrar</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Teclas</th>
                    <th>Acción</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Abrir esta ayuda</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Página siguiente</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Página anterior</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Buscar</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
